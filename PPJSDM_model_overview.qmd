---
title: "PPJSDM_model_overview"
format: html
editor: visual
---

## Model Overview

The document describes the saturated pairwise interaction Gibbs point process model developed by Flint et al (2022). This model belongs to the broader class of spatial point process models which involves modelling of collections of individuals that have associated with them a coordinate in space, and at times extra information such as species or size of the point, to understand their distribution. Gibbs point processes are a class of models that allow for interactions between points, where the interactions can be negative (repulsion) or positive (attraction). Therefore, this model can explicitly quantify the strength and sign of pairwise interactions between any group (which may be a species or otherwise) of individuals specified at a range of scales.

An interaction in this model is a process that affects the likelihood of finding two individuals at a given distance from one another. The nature of the interaction, whether it is positive or negative, is derived from the likelihood. Therefore, if two individuals of a certain group are highly likely to be found close to each other for the given interaction radius, the model will give a strong positive coefficient for the interaction of the group with itself and so we say the individuals are attracted to each other or clustered together. If two individuals from two different groups are highly unlikely to be found close to each other for the given interaction radius, the model will give a strong negative coefficient for the interaction of that group to the other and we can say the individuals are repulsed from each other. Fundamental to the model are the parameters of the short-range potential function and the short-range interaction radii distances (R^S^). All model outputs and inferences of the outputs are within the context of these parameters. 

The short-range interaction radii are the typical distances from an individual where the likelihood of finding other individuals is affected. For instance, if the short-range interaction radius value is set to three, the magnitude of the effect of another individual on the focal individual is halved at a three-metre radius from the focal individuals and continues to decrease with distance. Thus, a short-range interaction coefficient only has meaning when accompanied with the short-range interaction radii values as parameterised. In general, if an individual is a plant, the short-range interaction radius is proportion to its crown size.

The short-range potential function describes the shape of the interaction potential and is dependent on the short-range interaction radii values. The function describes the change in the likelihood of finding two individuals close to each other through distance from the focal individual for the given short-range radii values. When the potential function has a large value, this corresponds to a stronger interaction. The interaction potential function may sharply decline to zero from a specific distance or decline smoothly through distance. This can be expressed through different short-range potential shapes such as the step function which declines steeply, or the exponential function which declines smoothly, and can be correlated to aspects of ecology between the two considered individuals. The model can also account for medium- and long-range interaction in the same way as described above.

Another important parameter in the model is the saturation parameter (N). The focal tree only affects the likelihood of finding other trees if they are among the N closest neighbours to itself, based on resources being finite in a given neighbourhood (Rajala et al., 2018). Therefore, a saturation parameter is defined. 

Lastly, the model allows for the addition of environmental covariates as parameters, which can account for environmental effects on the arrangement of individuals in space. These are specified as a pixel image (im object in R) and can be, but are not limited to, gradients of the environment such as elevation or aridity, areas of past events such as fire, or even stationary objects in the environment such as roads. The model produces a coefficient of each group in the model to each environmental covariate. Thus, an environmental coefficient of +0.5 would mean the likelihood of finding an individual of that group increases by 0.5 with every unit increase in the environmental covariate. By comparing the relative magnitude of coefficients of pairs of groups and groups to each environmental covariate, the importance of environmental covariates compared to group associations in determining distribution can be examined.\*

The model assesses interactions between groups and produces a matrix of beta and alpha interaction coefficients. The beta coefficients when multiplied by the covariates, give the log-intensity (density) of each group if there were no interactions occurring between individuals. The alpha coefficients, or interaction coefficients, is produced for each pair of groups included in the model for the given short-range radii value. The magnitude and direction (negative or positive) of the interaction coefficient gives us the effect on the likelihood of finding two individuals of the two groups close to each other for the short-range interaction radii values. Therefore, an interaction coefficient of -1.5 would mean the log-likelihood of finding one individual of one group close to another individual of another group decreases by 1.5 when individuals are at the given interaction distance (R). Importantly, the interaction coefficients are symmetric meaning that the effect of group A on B is the same as the effect of group B on A. Finally, confidence intervals (CIs) around the coefficient are also produced and significance is assessed based on the z-value. 

The model outputs also include a ‘se_numerical_proportion’ column which indicates what percent of the standard error (SE) is due to numerical uncertainty. The amount of numerical depends on the distribution and number of dummy points, which are analogous to background points of other models such as Maxent. Dummy points can take a certain distribution through the region included in the model of binomial or stratified, which is more regularly drawn over space. A certain number of dummy points can be chosen for each group or type included in the model. These randomly distributed dummy points act as ‘pseudo-absences’ as they correspond to absences in the analogous logistic regression, and this can be used to approximate the fit of the point process likelihood. The larger the number of dummy points used the more closely approximately the point process is. 

The model is utilised in RStudio, using the package ‘ppjsdm’.

## Model Equation

![The saturated pairwise Gibbs point process model equation. The intensity of points, j(w) is known and is the dataset of locations of trees. We solve this equation for the alpha and beta coefficients.](images/Picture1-01.png){width="794"}

## Various Notes on Model Behaviour

Note: Some model parameters are technically hyperparameters. These are parameters that are chosen beforehand, not by fitting by the model and parameters that driving the other ones. The shape of the interaction potential affects all the parameters lower in the hierarchy. Therefore it is a hyperparameter (from Bayesian stats), fits simultaneously the parameters than you study and ones that affect the parameters (hyperparameters). In some cases, when you fix parameters or choose a shape/distance this implies as hyperparameters

### Beta Coefficients

\*In my work, I have transformed the covariates so that each covariate has a variance of around one. This makes coefficients easier to interpret as for all covariates included in the model a coefficient of +/-0.5 is a large response, a coefficient of +/- 2 is a massive response and a coefficient of +/-0.1 is a mild response. When interpreting scaled coefficient, do not scale them back as they are already in their most easy to interpret form as a coefficient of x value means the same response for each covariate.

However to understand what a coefficient of say -0.5 is doing we need to scale the covariates back. For example, I divided the elevation covariate by 100. A coefficient of -0.5 means that for every 100m movement of elevation, the likelihood of finding that particular group decreases by 0.5.

In complex datasets if parameters are changed slightly, this can result in very different beta coefficients. The beta coefficients are not stable and this can easily change the conditional intensity plots. The conditional intensity plots are a function of the covariates and there are many ways to achieve this. This is especially the case if covariates are correlated. A linear combination of multiple covariates can give an output in different ways. For example, the graph below. The x-axis is one-dimensional space, and the y-axis is the intensity of points and the covariates. The red line is the intensity of the individual that you want to estimate. There is a covariate called water and it has a one-to-one relationship with the beta intensity of the points.

We can have two more covariates: pH and temperature. You can add pH and temperature lines together and flip it (minus sign) to get the equivalent of the water curve. Although the water covariate has only one way to explain the intensity, the model with the two covariates has **multiple** ways to explain the intensity. We can combine the two covariates in different ways to estimate the intensity.

Therefore when we add multiple covariates into the model, it can explain either through the water covariate or the two other ones, depending on slight things. Small changes in the saturation and short-range can give different responses. So, when the model has a lot of covariates, the model can interpret this in multiple ways due to correlation in the covariates.

![](images/Picture2.svg)
